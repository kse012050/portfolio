<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>reservation</title>
    <link rel="icon" href="../img/faviconE58F3A.ico" type="image/x-icon" />
    <link href="import.css" rel="stylesheet" />
</head>
<body>
    <header>
        <h1><a href="../index.html">LOGO</a></h1>

        <input type="checkbox" id="menu" />

        <nav class="menuMain">
            <label for="menu">
                <span></span>
                <span></span>
                <span></span>
            </label>
            <div>
                <ul>
                    <li><a href="#">호텔소개</a></li>
                    <li><a href="#">객실</a></li>
                    <li><a href="#">다이닝</a></li>
                    <li><h2><a href="#">logo</a></h2></li>
                    <li><a href="#">웨딩&연회</a></li>
                    <li><a href="#">피트니스</a></li>
                    <li><a href="#">특별한혜택</a></li>
                </ul>
            </div>
            <span>
                <a href="#">예약</a>
            </span>
        </nav>

        <nav class="menuArea">
            <ul>
                <li>
                    <h2>호텔소개</h2>
                    <ol>
                        <li><a href="#">소개</a></li>
                        <li><a href="#">층별안내</a></li>
                        <li><a href="#">오시는길</a></li>
                        <li><a href="#">주변환경</a></li>
                    </ol>
                </li>
                <li>
                    <h2>객실</h2>
                    <ol>
                        <li><a href="#">All Rooms</a></li>
                        <li><a href="#">Double</a></li>
                        <li><a href="#">Twin</a></li>
                        <li><a href="#">Superior</a></li>
                        <li><a href="#">Deluxe</a></li>
                        <li><a href="#">Junior Suite</a></li>
                        <li><a href="#">Parlor Suite</a></li>
                        <li><a href="#">Executive Suite</a></li>
                        <li><a href="#">Stanford Suite</a></li>
                    </ol>
                </li>
                <li>
                    <h2>다이닝</h2>
                    <ol>
                        <li><a href="#">카페 스탠포드</a></li>
                        <li><a href="#">맨하탄 그릴&바</a></li>
                    </ol>
                </li>
                <li>
                    <h2>웨딩&연회</h2>
                    <ol>
                        <li><a href="#">웨딩</a></li>
                        <li><a href="#">가족연</a></li>
                        <li><a href="#">기업연회</a></li>
                        <li><a href="#">연회장</a></li>
                    </ol>
                </li>
                <li>
                    <h2>피트니스</h2>
                    <ol>
                        <li><a href="#">피트니스 소개</a></li>
                        <li><a href="#">실내수영장</a></li>
                        <li><a href="#">체련장</a></li>
                        <li><a href="#">피트니스 멤버쉽</a></li>
                    </ol>
                </li>

                <li>
                    <h2>특별한혜택</h2>
                    <ol>
                        <li><a href="#">프로모션</a></li>
                        <li><a href="#">패키지</a></li>
                    </ol>
                </li>
            </ul>
        </nav>
    </header>
    
    <section class="reservationCalender">
        <h2>예약하기</h2>

        <ul>
            <li>STEP 02 객실 선택하기</li>
            <li>STEP 02 고객정보 입력하기</li>
            <li>STEP 02 예약확인하기</li>
        </ul>

        <ol>
            <li>
                <table>
                    <caption>달력</caption>
                    <tr>
                        <th colspan="7"> </th>
                    </tr>
                    <tr>
                        <th>일</th>
                        <th>월</th>
                        <th>화</th>
                        <th>수</th>
                        <th>목</th>
                        <th>금</th>
                        <th>토</th>
                    </tr>
                </table>
            </li>
            <li>
                <table>
                    <caption>달력</caption>
                    <tr>
                        <th colspan="7"> </th>
                    </tr>
                    <tr>
                        <th>일</th>
                        <th>월</th>
                        <th>화</th>
                        <th>수</th>
                        <th>목</th>
                        <th>금</th>
                        <th>토</th>
                    </tr>
                </table>
            </li>
        </ol>
        <section>
            <ul>
                <li>
                    <dl>
                        <dt>체크인</dt>
                        <dd> </dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>체크아웃</dt>
                        <dd> </dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>성인</dt>
                        <dd> </dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>소아</dt>
                        <dd> </dd>
                    </dl>
                </li>
                <li>
                    <button>객실조회</button>
                </li>
            </ul>
        </section>

        <div>
            <dl>
                <dt>성인 <span>만 12세 이상</span></dt>
                <dd>0명</dd>
                <dd>1명</dd>
                <dd>2명</dd>
                <dd>3명</dd>
                <dd>4명</dd>
            </dl>
            <dl>
                <dt>아이 <span>만 11세 이하</span></dt>
                <dd>0명</dd>
                <dd>1명</dd>
                <dd>2명</dd>
            </dl>
            <button>선택완료</button>
        </div>

        <div>
            <button><</button>
            <button>></button>
        </div>
    </section>


    <footer>
        <ul>
            <li><a href="#">자주묻는질문</a></li>
            <li><a href="#">온라인문의</a></li>
            <li><a href="#">개인정보처리방침</a></li>
        </ul>
        <address>
            <ul>
                <li>㈜스탠포드호텔코리아</li>
                <li>대표자 : 권중갑</li>
                <li>주소 : 서울시 마포구 월드컵북로 58길 15(상암동)</li>
                <li>TEL : 02-6016-0001</li>
                <li>FAX : 02-6016-0002</li>
            </ul>
            <p></p>
        </address>

        <ul>
            <li><p>사업자등록번호 : 220-87-18352</p></li>
            <li><p>통신판매업신고 : 2011-서울마포-1318</p></li>
        </ul>

        <p>
            COPYRIGHT © StanfordHotel Co. Ltd. All rights reserved.
        </p>

        <select onchange="if(this.value) window.open(this.value);">
            <option>스탠포드호텔사이트</option>
            <option value="">스탠포드호텔그룹</option>
            <option value="">스탠포드호텔&리조트 통영</option>
            <option value="">스탠포드인 부산</option>
        </select>
    </footer>

    <script src="../js/common.js"></script>

    <script>
        var receivedData = location.href.split("?");
        var dataDivision = receivedData[1].split('.');
        //for (var i = 0; i < dataDivision.length; i++) {
        //    console.log('dataDivision'+i+' = ' + dataDivision[i]);
        //}



        // 달력
        var today = new Date();
        var nextMonth = new Date();
        var DateCheck = new Date();;
        var finalMonth = '';
        var nextFinalMonth = '';

        var todyFirstDay = new Date(today.getFullYear(), today.getMonth(), 1);
        var todayLastDate = new Date(today.getFullYear(), today.getMonth() + 1, 0);

        var nextMonthFirstDay = new Date(today.getFullYear(), today.getMonth() + 1, 1);
        var nextMonthLastDate = new Date(today.getFullYear(), today.getMonth() + 2, 0);

        if (dataDivision[0].indexOf('%20') != -1) {
            dataDivision[0] = todyFirstDay.getFullYear();
            dataDivision[3] = nextMonthFirstDay.getFullYear();
        } 

        // 년월 타이틀
        var titleInsertDate = document.querySelectorAll('.reservationCalender ol li table tr:first-of-type th');
        // 체크인 / 체크아웃
        var insertingReceivedData = document.querySelectorAll('.reservationCalender section ul li dl dd');

        var prevNextCalenter = document.querySelectorAll('.reservationCalender div button');

        // 체크인 / 체크아웃
        insertingReceivedData[0].firstChild.appendData(dataDivision[0] + '.' + dataDivision[1] + '.' + dataDivision[2]);
        insertingReceivedData[1].firstChild.appendData(dataDivision[3] + '.' + dataDivision[4] + '.' + dataDivision[5]);
;
        if (dataDivision[1] > (today.getMonth() + 1)) {
            finalMonth = (dataDivision[1] - (today.getMonth() + 1)) + ((dataDivision[0] - today.getFullYear()) * 12);
        } else if (dataDivision[1] < (today.getMonth() + 1)) {
            finalMonth = (((dataDivision[0] - today.getFullYear()) * 12) - ((today.getMonth() + 1) - dataDivision[1]));
        } else {
            finalMonth = 0;
        }

        function calender() {
            var todyFirstDay = new Date(today.getFullYear(), today.getMonth() + finalMonth , 1);
            var todayLastDate = new Date(today.getFullYear(), today.getMonth() + finalMonth  + 1, 0);

            var nextMonthFirstDay = new Date(today.getFullYear(), today.getMonth() + finalMonth + 1, 1);
            var nextMonthLastDate = new Date(today.getFullYear(), today.getMonth() + finalMonth + 2, 0);

            var reservationCalendar = document.querySelectorAll('.reservationCalender ol li table');

            // 년월 타이틀
            titleInsertDate[0].firstChild.replaceData(0,1,todyFirstDay.getFullYear() + '.' + (todyFirstDay.getMonth() + 1));
            titleInsertDate[1].firstChild.replaceData(0, 1,nextMonthFirstDay.getFullYear() + '.' + (nextMonthFirstDay.getMonth() + 1));

            while (reservationCalendar[0].rows.length > 2) {
                reservationCalendar[0].deleteRow(reservationCalendar[0].rows.length - 1);
            }
            while (reservationCalendar[1].rows.length > 2) {
                reservationCalendar[1].deleteRow(reservationCalendar[1].rows.length - 1);
            }

            var row = null;
            row = reservationCalendar[0].insertRow();
            var cnt = 0;
            var cell;

            for (var i = 0; i < todyFirstDay.getDay(); i++) {
                cell = row.insertCell();
                cnt = cnt + 1;
            }

            for (var i = 1; i <= todayLastDate.getDate(); i++) {
                cell = row.insertCell();
                cell.innerHTML = i;
                cnt = cnt + 1;
                if (cnt % 7 == 0) {
                    row = reservationCalendar[0].insertRow();
                }
            }


            var nextRow = null;
            var nextCnt = 0;
            var nextCell;
            nextRow = reservationCalendar[1].insertRow();

            for (var i = 0; i < nextMonthFirstDay.getDay(); i++) {
                nextCell = nextRow.insertCell();
                nextCnt = nextCnt + 1;
            }

            for (var i = 1; i <= nextMonthLastDate.getDate(); i++) {
                nextCell = nextRow.insertCell();
                nextCell.innerHTML = i;
                nextCnt = nextCnt + 1;
                if (nextCnt % 7 == 0) {
                    nextRow = reservationCalendar[1].insertRow();
                }
            }

            var calendarDate = document.querySelectorAll('.reservationCalender ol li table tr td');

            if (titleInsertDate[0].firstChild.length == 7) {
                if ((DateCheck.getMonth() + 1) == titleInsertDate[0].firstChild.substringData(6, 1)) {
                    for (var i = 0; i < today.getDate() - 1; i++) {
                        calendarDate[i].classList.add('lastDay');
                    };
                };
            } else {
                if ((DateCheck.getMonth() + 1) == titleInsertDate[0].firstChild.substringData(5, 1)) {
                    for (var i = 0; i < today.getDate() - 1; i++) {
                        calendarDate[i].classList.add('lastDay');
                    };
                };
            };
            for (var i = 0; i < calendarDate.length; i++) {
                if (calendarDate[i].innerHTML == '') {
                    calendarDate[i].classList.add('lastDay');
                }
            }

            // 달력 클릭
            var calendarDateClickNumber = 0;
            var calendarDateClickNumberIdx = 0;
            for (var i = 0; i < calendarDate.length; i++) {
                if (calendarDate[i].innerHTML != '') {
                    calendarDate[i].addEventListener('click', calendarDateClick.bind(null, i));
                }
            };
            
            function calendarDateClick(idx) {
                if (calendarDate[idx].className != 'lastDay') {
                    if ((Math.ceil(calendarDate.length / 2)) > idx) {
                        if (calendarDateClickNumberIdx < idx) {
                            if (calendarDateClickNumber == 0) {
                                for (var i = 0; i < calendarDate.length; i++) {
                                    if (calendarDate[i].className != 'lastDay') {
                                        calendarDate[i].className = '';
                                    };
                                };
                                calendarDate[idx].classList.add('reservationDateCheck');
                                insertingReceivedData[0].firstChild.replaceData(0, 20, todyFirstDay.getFullYear() + '.' + (todyFirstDay.getMonth() + 1) + '.' + calendarDate[idx].innerHTML);
                                insertingReceivedData[1].firstChild.replaceData(0, 20, '. .');
                                calendarDateClickNumber = 1;
                                calendarDateClickNumberIdx = idx;
                            } else {
                                for (var i = calendarDateClickNumberIdx + 1; i < idx; i++) {
                                    calendarDate[i].classList.add('reservationDateCheckPeriod');
                                };
                                calendarDate[idx].classList.add('reservationDateCheck');
                                calendarDateClickNumber = 0;
                                insertingReceivedData[1].firstChild.replaceData(0, 20, todyFirstDay.getFullYear() + '.' + (todyFirstDay.getMonth() + 1) + '.' + calendarDate[idx].innerHTML);

                            }
                        } else {
                            for (var i = 0; i < calendarDate.length; i++) {
                                if (calendarDate[i].className != 'lastDay') {
                                    calendarDate[i].className = '';
                                };
                            };
                            calendarDate[idx].classList.add('reservationDateCheck');
                            insertingReceivedData[0].firstChild.replaceData(0, 20, todyFirstDay.getFullYear() + '.' + (todyFirstDay.getMonth() + 1) + '.' + calendarDate[idx].innerHTML);
                            calendarDateClickNumber = 1;
                            calendarDateClickNumberIdx = idx;
                        }
                    } else {
                        if (calendarDateClickNumberIdx < idx) {
                            if (calendarDateClickNumber == 1) {
                                for (var i = calendarDateClickNumberIdx + 1; i < idx; i++) {
                                    if (calendarDate[i].className != 'lastDay') {
                                        calendarDate[i].classList.add('reservationDateCheckPeriod');
                                    };
                                };
                                calendarDate[idx].classList.add('reservationDateCheck');
                                insertingReceivedData[1].firstChild.replaceData(0, 20, nextMonthFirstDay.getFullYear() + '.' + (nextMonthFirstDay.getMonth() + 1) + '.' + calendarDate[idx].innerHTML);
                                calendarDateClickNumberIdx = 0;
                                calendarDateClickNumber = 0;
                            } else {
                                for (var i = 0; i < calendarDate.length; i++) {
                                    if (calendarDate[i].className != 'lastDay') {
                                        calendarDate[i].className = '';
                                    };
                                };
                                calendarDate[idx].classList.add('reservationDateCheck');
                                insertingReceivedData[0].firstChild.replaceData(0, 20, nextMonthFirstDay.getFullYear() + '.' + (nextMonthFirstDay.getMonth() + 1) + '.' + calendarDate[idx].innerHTML);
                                insertingReceivedData[1].firstChild.replaceData(0, 20, '. .');
                                calendarDateClickNumberIdx = idx;
                                calendarDateClickNumber = 1;
                            };
                        } else {
                            for (var i = 0; i < calendarDate.length; i++) {
                                if (calendarDate[i].className != 'lastDay') {
                                    calendarDate[i].className = '';
                                };
                            };
                            calendarDate[idx].classList.add('reservationDateCheck');
                            insertingReceivedData[0].firstChild.replaceData(0, 20, nextMonthFirstDay.getFullYear() + '.' + (nextMonthFirstDay.getMonth() + 1) + '.' + calendarDate[idx].innerHTML);
                            insertingReceivedData[1].firstChild.replaceData(0, 20, '. .');
                            calendarDateClickNumberIdx = idx;
                            calendarDateClickNumber = 1;
                        }
                    };
                };
            }
        }


        // 달력 출력
        calender();

        var calendarDate = document.querySelectorAll('.reservationCalender ol li table tr td');

        // 기본 데이터 받아오기
        for (var i = 0; i < Math.ceil(calendarDate.length / 2) + 2; i++) {
            if (calendarDate[i].innerHTML != '') {
                if (calendarDate[i].innerHTML == dataDivision[2]) {
                    calendarDate[i].classList.add('reservationDateCheck');
                };
                if (Number(calendarDate[i].innerHTML) > dataDivision[2]) {
                    calendarDate[i].classList.add('reservationDateCheckPeriod');
                };

            }
            if (dataDivision[1] == dataDivision[4]) {
                if (calendarDate[i].innerHTML == dataDivision[5]) {
                    calendarDate[i].classList.add('reservationDateCheck');
                };
                if (Number(calendarDate[i].innerHTML) >= dataDivision[5]) {
                    calendarDate[i].classList.remove('reservationDateCheckPeriod');
                };
            }
        }

        if (dataDivision[1] != dataDivision[4]) {
            for (var i = Math.floor(calendarDate.length / 2); i < calendarDate.length; i++) {
                if (calendarDate[i].innerHTML == dataDivision[5]) {
                    calendarDate[i].classList.add('reservationDateCheck');
                };
                if (Number(calendarDate[i].innerHTML) < dataDivision[5]) {
                    calendarDate[i].classList.add('reservationDateCheckPeriod');
                }
            }
        }
        
        prevNextCalenter[1].addEventListener('click', function () {
            if (DateCheck.getFullYear() != titleInsertDate[0].firstChild.substringData(1, 4)) {
                if ((DateCheck.getMonth() + 1) != titleInsertDate[0].firstChild.substringData(5, 2)) {
                    today = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
                    titleInsertDate[0].firstChild.replaceData(0, 20, '');
                    titleInsertDate[1].firstChild.replaceData(0, 20, '');
                    calender();
                    insertingReceivedData[0].firstChild.replaceData(0, 20, '. .');
                    insertingReceivedData[1].firstChild.replaceData(0, 20, '. .');
                };
            };
        });

        prevNextCalenter[2].addEventListener('click', function () {
            today = new Date(today.getFullYear(), today.getMonth() + 1, today.getDate());
            titleInsertDate[0].firstChild.replaceData(0, 20, '');
            titleInsertDate[1].firstChild.replaceData(0, 20, '');
            calender();
            insertingReceivedData[0].firstChild.replaceData(0, 20, '. .');
            insertingReceivedData[1].firstChild.replaceData(0, 20, '. .');
        });

        // 예약(성인/아이)
        var adultDateClick = document.querySelectorAll('.reservationCalender div:first-of-type dl:first-of-type dd');
        var childrenDateClick = document.querySelectorAll('.reservationCalender div:first-of-type dl:last-of-type dd');
        insertingReceivedData[2].firstChild.replaceData(0, 1, dataDivision[6]);
        insertingReceivedData[3].firstChild.replaceData(0, 1, dataDivision[7]);

        adultDateClick[dataDivision[6]].classList.add('NumberOfPeopleClick');
        childrenDateClick[dataDivision[7]].classList.add('NumberOfPeopleClick');

        // 성인
        for (var i = 0; i < adultDateClick.length; i++) {
            //console.log(adultDateClick[i].innerHTML);
            adultDateClick[i].addEventListener('click', function () {
                adultClass();
                var adultNumber = this.firstChild.substringData(0, 1);
                insertingReceivedData[2].firstChild.replaceData(0, 1, adultNumber);
                this.classList.add('NumberOfPeopleClick');
            });
        }

        function adultClass() {
            for (var i = 0; i < adultDateClick.length; i++) {
                adultDateClick[i].classList.remove('NumberOfPeopleClick');
            };
        }

        // 아이
        for (var i = 0; i < childrenDateClick.length; i++) {
            //console.log(childrenDateClick[i].innerHTML);
            childrenDateClick[i].addEventListener('click', function () {
                childrenClass();
                var childrenNumber = this.firstChild.substringData(0, 1);
                insertingReceivedData[3].firstChild.replaceData(0, 1, childrenNumber);
                this.classList.add('NumberOfPeopleClick');
            });
        }

        function childrenClass() {
            for (var i = 0; i < childrenDateClick.length; i++) {
                childrenDateClick[i].classList.remove('NumberOfPeopleClick');
            }
        }

        // 예약(성인/아이) 닫기
        var adultChild = document.querySelector('.reservationCalender div:first-of-type');
        var adultChildClick = document.querySelectorAll('.reservationCalender section ul li');

        for (var i = 2; i <= 3; i++) {
            adultChildClick[i].addEventListener('click', function () {
                adultChild.classList.add('display');
            });
        }

        prevNextCalenter[0].addEventListener('click', function () {
            adultChild.classList.remove('display');
        });

        // 제출
        var submission = document.querySelector('.reservationCalender section ul li button');

        submission.addEventListener('click', function () {
            if (insertingReceivedData[0].innerHTML == '. .' || insertingReceivedData[1].innerHTML =='. .') {
                alert('체크인 또는 체크아웃을 확인해주세요');
            } else {
                alert('체크인 : ' + insertingReceivedData[0].innerHTML + '\n체크아웃 : ' + insertingReceivedData[1].innerHTML + '\n성인 : ' + insertingReceivedData[2].innerHTML + '\n아이 : ' + insertingReceivedData[3].innerHTML);
            }
        });
    </script>
</body>
</html>